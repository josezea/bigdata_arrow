{"cells":[{"cell_type":"code","source":["from pyspark.sql.functions import *\nfrom pyspark.ml.feature import VectorAssembler\nfrom pyspark.ml.classification import RandomForestClassifier\nfrom pyspark.ml.classification import RandomForestClassificationModel\nfrom pyspark.ml.evaluation import BinaryClassificationEvaluator\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"50296e64-1916-4d4f-8128-01d86f75bc09"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["#read the dataset\n# Regresión logística\nubica_archivo = '/FileStore/tables/affairs.csv'\ndf = spark.read.csv(ubica_archivo, inferSchema = True, header = True)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"08aaacdf-9c79-4e87-9e5a-e7c3d8cb8c17"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"rate_marriage","nullable":true,"type":"integer"},{"metadata":{},"name":"age","nullable":true,"type":"double"},{"metadata":{},"name":"yrs_married","nullable":true,"type":"double"},{"metadata":{},"name":"children","nullable":true,"type":"double"},{"metadata":{},"name":"religious","nullable":true,"type":"integer"},{"metadata":{},"name":"affairs","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["#check the shape of the data \nprint((df.count(),len(df.columns)))"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"371db8bb-bb2e-4996-8078-e1e181e20862"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">(6366, 6)\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">(6366, 6)\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["df.printSchema()\n"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"b4d25b33-3d0c-40c4-863c-53c18e8c3e89"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">root\n |-- rate_marriage: integer (nullable = true)\n |-- age: double (nullable = true)\n |-- yrs_married: double (nullable = true)\n |-- children: double (nullable = true)\n |-- religious: integer (nullable = true)\n |-- affairs: integer (nullable = true)\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">root\n-- rate_marriage: integer (nullable = true)\n-- age: double (nullable = true)\n-- yrs_married: double (nullable = true)\n-- children: double (nullable = true)\n-- religious: integer (nullable = true)\n-- affairs: integer (nullable = true)\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["df.show(5)\n"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"881124e8-ce54-48a1-9510-1e199e149906"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+-------------+----+-----------+--------+---------+-------+\n|rate_marriage| age|yrs_married|children|religious|affairs|\n+-------------+----+-----------+--------+---------+-------+\n|            5|32.0|        6.0|     1.0|        3|      0|\n|            4|22.0|        2.5|     0.0|        2|      0|\n|            3|32.0|        9.0|     3.0|        3|      1|\n|            3|27.0|       13.0|     3.0|        1|      1|\n|            4|22.0|        2.5|     0.0|        1|      1|\n+-------------+----+-----------+--------+---------+-------+\nonly showing top 5 rows\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-------------+----+-----------+--------+---------+-------+\nrate_marriage| age|yrs_married|children|religious|affairs|\n+-------------+----+-----------+--------+---------+-------+\n            5|32.0|        6.0|     1.0|        3|      0|\n            4|22.0|        2.5|     0.0|        2|      0|\n            3|32.0|        9.0|     3.0|        3|      1|\n            3|27.0|       13.0|     3.0|        1|      1|\n            4|22.0|        2.5|     0.0|        1|      1|\n+-------------+----+-----------+--------+---------+-------+\nonly showing top 5 rows\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["#Exploratory Data Analysis\ndf.describe().select('summary','rate_marriage','age','yrs_married','children','religious').show()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"ab2054f3-66f9-42aa-892a-28bd2a604336"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+-------+------------------+------------------+-----------------+------------------+------------------+\n|summary|     rate_marriage|               age|      yrs_married|          children|         religious|\n+-------+------------------+------------------+-----------------+------------------+------------------+\n|  count|              6366|              6366|             6366|              6366|              6366|\n|   mean| 4.109644989004084|29.082862079798932| 9.00942507068803|1.3968740182218033|2.4261702796104303|\n| stddev|0.9614295945655025| 6.847881883668817|7.280119972766412| 1.433470828560344|0.8783688402641785|\n|    min|                 1|              17.5|              0.5|               0.0|                 1|\n|    max|                 5|              42.0|             23.0|               5.5|                 4|\n+-------+------------------+------------------+-----------------+------------------+------------------+\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-------+------------------+------------------+-----------------+------------------+------------------+\nsummary|     rate_marriage|               age|      yrs_married|          children|         religious|\n+-------+------------------+------------------+-----------------+------------------+------------------+\n  count|              6366|              6366|             6366|              6366|              6366|\n   mean| 4.109644989004084|29.082862079798932| 9.00942507068803|1.3968740182218033|2.4261702796104303|\n stddev|0.9614295945655025| 6.847881883668817|7.280119972766412| 1.433470828560344|0.8783688402641785|\n    min|                 1|              17.5|              0.5|               0.0|                 1|\n    max|                 5|              42.0|             23.0|               5.5|                 4|\n+-------+------------------+------------------+-----------------+------------------+------------------+\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["df.groupBy('affairs').count().show()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"e2f6596e-b874-47f3-8c6f-2dbc28501d84"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+-------+-----+\n|affairs|count|\n+-------+-----+\n|      1| 2053|\n|      0| 4313|\n+-------+-----+\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-------+-----+\naffairs|count|\n+-------+-----+\n      1| 2053|\n      0| 4313|\n+-------+-----+\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["df.groupBy('rate_marriage').count().show()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"772bf4e7-7962-44c5-bdb4-6254f2a8249e"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+-------------+-----+\n|rate_marriage|count|\n+-------------+-----+\n|            1|   99|\n|            3|  993|\n|            5| 2684|\n|            4| 2242|\n|            2|  348|\n+-------------+-----+\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-------------+-----+\nrate_marriage|count|\n+-------------+-----+\n            1|   99|\n            3|  993|\n            5| 2684|\n            4| 2242|\n            2|  348|\n+-------------+-----+\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["df.groupBy('rate_marriage','affairs').count().orderBy('rate_marriage','affairs','count',ascending=True).show()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"2498c6be-9a10-4df5-b9d7-18036bc62f5d"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+-------------+-------+-----+\n|rate_marriage|affairs|count|\n+-------------+-------+-----+\n|            1|      0|   25|\n|            1|      1|   74|\n|            2|      0|  127|\n|            2|      1|  221|\n|            3|      0|  446|\n|            3|      1|  547|\n|            4|      0| 1518|\n|            4|      1|  724|\n|            5|      0| 2197|\n|            5|      1|  487|\n+-------------+-------+-----+\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-------------+-------+-----+\nrate_marriage|affairs|count|\n+-------------+-------+-----+\n            1|      0|   25|\n            1|      1|   74|\n            2|      0|  127|\n            2|      1|  221|\n            3|      0|  446|\n            3|      1|  547|\n            4|      0| 1518|\n            4|      1|  724|\n            5|      0| 2197|\n            5|      1|  487|\n+-------------+-------+-----+\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["df.groupBy('religious','affairs').count().orderBy('religious','affairs','count',ascending=True).show()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"e0e0e771-9fa4-45b7-a729-bcc08831ec4d"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+---------+-------+-----+\n|religious|affairs|count|\n+---------+-------+-----+\n|        1|      0|  613|\n|        1|      1|  408|\n|        2|      0| 1448|\n|        2|      1|  819|\n|        3|      0| 1715|\n|        3|      1|  707|\n|        4|      0|  537|\n|        4|      1|  119|\n+---------+-------+-----+\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+---------+-------+-----+\nreligious|affairs|count|\n+---------+-------+-----+\n        1|      0|  613|\n        1|      1|  408|\n        2|      0| 1448|\n        2|      1|  819|\n        3|      0| 1715|\n        3|      1|  707|\n        4|      0|  537|\n        4|      1|  119|\n+---------+-------+-----+\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["df.groupBy('children','affairs').count().orderBy('children','affairs','count',ascending=True).show()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"11844802-f425-4f42-805c-f4514f8ab41f"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+--------+-------+-----+\n|children|affairs|count|\n+--------+-------+-----+\n|     0.0|      0| 1912|\n|     0.0|      1|  502|\n|     1.0|      0|  747|\n|     1.0|      1|  412|\n|     2.0|      0|  873|\n|     2.0|      1|  608|\n|     3.0|      0|  460|\n|     3.0|      1|  321|\n|     4.0|      0|  197|\n|     4.0|      1|  131|\n|     5.5|      0|  124|\n|     5.5|      1|   79|\n+--------+-------+-----+\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+--------+-------+-----+\nchildren|affairs|count|\n+--------+-------+-----+\n     0.0|      0| 1912|\n     0.0|      1|  502|\n     1.0|      0|  747|\n     1.0|      1|  412|\n     2.0|      0|  873|\n     2.0|      1|  608|\n     3.0|      0|  460|\n     3.0|      1|  321|\n     4.0|      0|  197|\n     4.0|      1|  131|\n     5.5|      0|  124|\n     5.5|      1|   79|\n+--------+-------+-----+\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["df.groupBy('affairs').mean().show()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"6d40f1cc-18b5-41d8-906f-1b5c0227bf57"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+-------+------------------+------------------+------------------+------------------+------------------+------------+\n|affairs|avg(rate_marriage)|          avg(age)|  avg(yrs_married)|     avg(children)|    avg(religious)|avg(affairs)|\n+-------+------------------+------------------+------------------+------------------+------------------+------------+\n|      1|3.6473453482708234|30.537018996590355|11.152459814905017|1.7289332683877252| 2.261568436434486|         1.0|\n|      0| 4.329700904242986| 28.39067934152562| 7.989334569904939|1.2388128912589844|2.5045212149316023|         0.0|\n+-------+------------------+------------------+------------------+------------------+------------------+------------+\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-------+------------------+------------------+------------------+------------------+------------------+------------+\naffairs|avg(rate_marriage)|          avg(age)|  avg(yrs_married)|     avg(children)|    avg(religious)|avg(affairs)|\n+-------+------------------+------------------+------------------+------------------+------------------+------------+\n      1|3.6473453482708234|30.537018996590355|11.152459814905017|1.7289332683877252| 2.261568436434486|         1.0|\n      0| 4.329700904242986| 28.39067934152562| 7.989334569904939|1.2388128912589844|2.5045212149316023|         0.0|\n+-------+------------------+------------------+------------------+------------------+------------------+------------+\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["df_assembler = VectorAssembler(inputCols=['rate_marriage', 'age', 'yrs_married', 'children', 'religious'], outputCol=\"features\")\ndf = df_assembler.transform(df)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"84ee0e8e-23ac-4609-b8c7-cb8563d1bf4a"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"rate_marriage","nullable":true,"type":"integer"},{"metadata":{},"name":"age","nullable":true,"type":"double"},{"metadata":{},"name":"yrs_married","nullable":true,"type":"double"},{"metadata":{},"name":"children","nullable":true,"type":"double"},{"metadata":{},"name":"religious","nullable":true,"type":"integer"},{"metadata":{},"name":"affairs","nullable":true,"type":"integer"},{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"rate_marriage"},{"idx":1,"name":"age"},{"idx":2,"name":"yrs_married"},{"idx":3,"name":"children"},{"idx":4,"name":"religious"}]},"num_attrs":5}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null}],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["df.printSchema()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"edbd27be-7d9c-4bc7-a026-302032c832c6"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">root\n |-- rate_marriage: integer (nullable = true)\n |-- age: double (nullable = true)\n |-- yrs_married: double (nullable = true)\n |-- children: double (nullable = true)\n |-- religious: integer (nullable = true)\n |-- affairs: integer (nullable = true)\n |-- features: vector (nullable = true)\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">root\n-- rate_marriage: integer (nullable = true)\n-- age: double (nullable = true)\n-- yrs_married: double (nullable = true)\n-- children: double (nullable = true)\n-- religious: integer (nullable = true)\n-- affairs: integer (nullable = true)\n-- features: vector (nullable = true)\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["df.select(['features','affairs']).show(10,False)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"5349b0a3-697f-440c-81ff-f083f997c7e0"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+-----------------------+-------+\n|features               |affairs|\n+-----------------------+-------+\n|[5.0,32.0,6.0,1.0,3.0] |0      |\n|[4.0,22.0,2.5,0.0,2.0] |0      |\n|[3.0,32.0,9.0,3.0,3.0] |1      |\n|[3.0,27.0,13.0,3.0,1.0]|1      |\n|[4.0,22.0,2.5,0.0,1.0] |1      |\n|[4.0,37.0,16.5,4.0,3.0]|1      |\n|[5.0,27.0,9.0,1.0,1.0] |1      |\n|[4.0,27.0,9.0,0.0,2.0] |1      |\n|[5.0,37.0,23.0,5.5,2.0]|1      |\n|[5.0,37.0,23.0,5.5,2.0]|1      |\n+-----------------------+-------+\nonly showing top 10 rows\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-----------------------+-------+\nfeatures               |affairs|\n+-----------------------+-------+\n[5.0,32.0,6.0,1.0,3.0] |0      |\n[4.0,22.0,2.5,0.0,2.0] |0      |\n[3.0,32.0,9.0,3.0,3.0] |1      |\n[3.0,27.0,13.0,3.0,1.0]|1      |\n[4.0,22.0,2.5,0.0,1.0] |1      |\n[4.0,37.0,16.5,4.0,3.0]|1      |\n[5.0,27.0,9.0,1.0,1.0] |1      |\n[4.0,27.0,9.0,0.0,2.0] |1      |\n[5.0,37.0,23.0,5.5,2.0]|1      |\n[5.0,37.0,23.0,5.5,2.0]|1      |\n+-----------------------+-------+\nonly showing top 10 rows\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["#select data for building model\nmodel_df=df.select(['features','affairs'])"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"f4b4e4f6-cebc-4ee6-8364-48431fd48f7e"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[{"name":"model_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"rate_marriage"},{"idx":1,"name":"age"},{"idx":2,"name":"yrs_married"},{"idx":3,"name":"children"},{"idx":4,"name":"religious"}]},"num_attrs":5}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"affairs","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["train_df,test_df=model_df.randomSplit([0.75,0.25])"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"8e4e0f38-3420-4bca-bafd-e818b48714f8"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[{"name":"train_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"rate_marriage"},{"idx":1,"name":"age"},{"idx":2,"name":"yrs_married"},{"idx":3,"name":"children"},{"idx":4,"name":"religious"}]},"num_attrs":5}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"affairs","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"test_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"rate_marriage"},{"idx":1,"name":"age"},{"idx":2,"name":"yrs_married"},{"idx":3,"name":"children"},{"idx":4,"name":"religious"}]},"num_attrs":5}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"affairs","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["train_df.count()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"2ddd9ff9-5d2a-4d87-bee3-6187a8b80fe5"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">Out[26]: 4799</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">Out[26]: 4799</div>"]}}],"execution_count":0},{"cell_type":"code","source":["train_df.groupBy('affairs').count().show()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"d14bae36-b7b0-4a23-9b3b-8bed066fa635"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+-------+-----+\n|affairs|count|\n+-------+-----+\n|      1| 1582|\n|      0| 3217|\n+-------+-----+\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-------+-----+\naffairs|count|\n+-------+-----+\n      1| 1582|\n      0| 3217|\n+-------+-----+\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["test_df.groupBy('affairs').count().show()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"560e8f5f-bc6f-4c74-a643-fe46c56e20cb"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+-------+-----+\n|affairs|count|\n+-------+-----+\n|      1|  471|\n|      0| 1096|\n+-------+-----+\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-------+-----+\naffairs|count|\n+-------+-----+\n      1|  471|\n      0| 1096|\n+-------+-----+\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["rf_classifier=RandomForestClassifier(labelCol='affairs',numTrees=50).fit(train_df)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"6d967bcb-7ffb-45d8-bd15-46e65ac2ac77"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["rf_predictions=rf_classifier.transform(test_df)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"c4e761ca-56fa-4922-8957-277a81015da5"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[{"name":"rf_predictions","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"rate_marriage"},{"idx":1,"name":"age"},{"idx":2,"name":"yrs_married"},{"idx":3,"name":"children"},{"idx":4,"name":"religious"}]},"num_attrs":5}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"affairs","nullable":true,"type":"integer"},{"metadata":{"ml_attr":{"num_attrs":2}},"name":"rawPrediction","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"num_attrs":2}},"name":"probability","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"num_vals":2,"type":"nominal"}},"name":"prediction","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["rf_predictions.show()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"aa20d00d-9831-4e35-8dbf-ee68eae9f97b"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+--------------------+-------+--------------------+--------------------+----------+\n|            features|affairs|       rawPrediction|         probability|prediction|\n+--------------------+-------+--------------------+--------------------+----------+\n|[1.0,22.0,2.5,1.0...|      1|[23.3304714045879...|[0.46660942809175...|       1.0|\n|[1.0,27.0,6.0,2.0...|      1|[17.3656314035188...|[0.34731262807037...|       1.0|\n|[1.0,32.0,13.0,0....|      1|[19.2965151098106...|[0.38593030219621...|       1.0|\n|[1.0,32.0,13.0,2....|      1|[13.9565904646282...|[0.27913180929256...|       1.0|\n|[1.0,32.0,13.0,3....|      1|[15.1280118483692...|[0.30256023696738...|       1.0|\n|[1.0,32.0,16.5,2....|      1|[13.5768861176392...|[0.27153772235278...|       1.0|\n|[1.0,37.0,13.0,1....|      1|[25.7548637082375...|[0.51509727416475...|       0.0|\n|[1.0,37.0,13.0,3....|      0|[24.7979891745189...|[0.49595978349037...|       1.0|\n|[1.0,37.0,13.0,5....|      0|[18.5267269022879...|[0.37053453804575...|       1.0|\n|[1.0,37.0,16.5,2....|      1|[14.8851242739678...|[0.29770248547935...|       1.0|\n|[1.0,37.0,23.0,4....|      1|[14.6921036075894...|[0.29384207215178...|       1.0|\n|[1.0,37.0,23.0,5....|      1|[21.6793235424978...|[0.43358647084995...|       1.0|\n|[1.0,42.0,16.5,1....|      1|[14.2458117327880...|[0.28491623465576...|       1.0|\n|[1.0,42.0,16.5,5....|      1|[16.0294405788916...|[0.32058881157783...|       1.0|\n|[1.0,42.0,23.0,2....|      1|[20.0689589408374...|[0.40137917881674...|       1.0|\n|[1.0,42.0,23.0,4....|      1|[16.2511514866173...|[0.32502302973234...|       1.0|\n|[2.0,17.5,0.5,0.0...|      0|[39.1916246301276...|[0.78383249260255...|       0.0|\n|[2.0,17.5,2.5,1.0...|      0|[26.4839188504118...|[0.52967837700823...|       0.0|\n|[2.0,22.0,2.5,0.0...|      1|[22.9915029565344...|[0.45983005913068...|       1.0|\n|[2.0,22.0,2.5,0.0...|      1|[22.9915029565344...|[0.45983005913068...|       1.0|\n+--------------------+-------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+--------------------+-------+--------------------+--------------------+----------+\n            features|affairs|       rawPrediction|         probability|prediction|\n+--------------------+-------+--------------------+--------------------+----------+\n[1.0,22.0,2.5,1.0...|      1|[23.3304714045879...|[0.46660942809175...|       1.0|\n[1.0,27.0,6.0,2.0...|      1|[17.3656314035188...|[0.34731262807037...|       1.0|\n[1.0,32.0,13.0,0....|      1|[19.2965151098106...|[0.38593030219621...|       1.0|\n[1.0,32.0,13.0,2....|      1|[13.9565904646282...|[0.27913180929256...|       1.0|\n[1.0,32.0,13.0,3....|      1|[15.1280118483692...|[0.30256023696738...|       1.0|\n[1.0,32.0,16.5,2....|      1|[13.5768861176392...|[0.27153772235278...|       1.0|\n[1.0,37.0,13.0,1....|      1|[25.7548637082375...|[0.51509727416475...|       0.0|\n[1.0,37.0,13.0,3....|      0|[24.7979891745189...|[0.49595978349037...|       1.0|\n[1.0,37.0,13.0,5....|      0|[18.5267269022879...|[0.37053453804575...|       1.0|\n[1.0,37.0,16.5,2....|      1|[14.8851242739678...|[0.29770248547935...|       1.0|\n[1.0,37.0,23.0,4....|      1|[14.6921036075894...|[0.29384207215178...|       1.0|\n[1.0,37.0,23.0,5....|      1|[21.6793235424978...|[0.43358647084995...|       1.0|\n[1.0,42.0,16.5,1....|      1|[14.2458117327880...|[0.28491623465576...|       1.0|\n[1.0,42.0,16.5,5....|      1|[16.0294405788916...|[0.32058881157783...|       1.0|\n[1.0,42.0,23.0,2....|      1|[20.0689589408374...|[0.40137917881674...|       1.0|\n[1.0,42.0,23.0,4....|      1|[16.2511514866173...|[0.32502302973234...|       1.0|\n[2.0,17.5,0.5,0.0...|      0|[39.1916246301276...|[0.78383249260255...|       0.0|\n[2.0,17.5,2.5,1.0...|      0|[26.4839188504118...|[0.52967837700823...|       0.0|\n[2.0,22.0,2.5,0.0...|      1|[22.9915029565344...|[0.45983005913068...|       1.0|\n[2.0,22.0,2.5,0.0...|      1|[22.9915029565344...|[0.45983005913068...|       1.0|\n+--------------------+-------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["rf_predictions.groupBy('prediction').count().show()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"a88eb140-16bb-4f8e-a9eb-3d62df1d765c"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+----------+-----+\n|prediction|count|\n+----------+-----+\n|       0.0| 1293|\n|       1.0|  274|\n+----------+-----+\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+----------+-----+\nprediction|count|\n+----------+-----+\n       0.0| 1293|\n       1.0|  274|\n+----------+-----+\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["rf_predictions.select(['probability','affairs','prediction']).show(10,False)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"344c55a9-f454-4ebe-9126-2e9c22f8b364"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+----------------------------------------+-------+----------+\n|probability                             |affairs|prediction|\n+----------------------------------------+-------+----------+\n|[0.46660942809175887,0.5333905719082412]|1      |1.0       |\n|[0.34731262807037633,0.6526873719296238]|1      |1.0       |\n|[0.3859303021962122,0.6140696978037877] |1      |1.0       |\n|[0.2791318092925659,0.720868190707434]  |1      |1.0       |\n|[0.3025602369673852,0.6974397630326148] |1      |1.0       |\n|[0.271537722352784,0.728462277647216]   |1      |1.0       |\n|[0.5150972741647513,0.4849027258352488] |1      |0.0       |\n|[0.4959597834903795,0.5040402165096206] |0      |1.0       |\n|[0.37053453804575837,0.6294654619542417]|0      |1.0       |\n|[0.2977024854793563,0.7022975145206437] |1      |1.0       |\n+----------------------------------------+-------+----------+\nonly showing top 10 rows\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+----------------------------------------+-------+----------+\nprobability                             |affairs|prediction|\n+----------------------------------------+-------+----------+\n[0.46660942809175887,0.5333905719082412]|1      |1.0       |\n[0.34731262807037633,0.6526873719296238]|1      |1.0       |\n[0.3859303021962122,0.6140696978037877] |1      |1.0       |\n[0.2791318092925659,0.720868190707434]  |1      |1.0       |\n[0.3025602369673852,0.6974397630326148] |1      |1.0       |\n[0.271537722352784,0.728462277647216]   |1      |1.0       |\n[0.5150972741647513,0.4849027258352488] |1      |0.0       |\n[0.4959597834903795,0.5040402165096206] |0      |1.0       |\n[0.37053453804575837,0.6294654619542417]|0      |1.0       |\n[0.2977024854793563,0.7022975145206437] |1      |1.0       |\n+----------------------------------------+-------+----------+\nonly showing top 10 rows\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["rf_accuracy=MulticlassClassificationEvaluator(labelCol='affairs',metricName='accuracy').evaluate(rf_predictions)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"d9ea68ed-61af-40f5-9f77-f5b35913380e"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["print('The accuracy of RF on test data is {0:.0%}'.format(rf_accuracy))"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"85ad5a31-c55d-4df4-bf83-f971efa7de8a"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">The accuracy of RF on test data is 72%\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">The accuracy of RF on test data is 72%\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["print(rf_accuracy)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"6a37ec5a-13d9-43fc-ad75-9f72a28e2d92"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">0.7223994894703255\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">0.7223994894703255\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["rf_precision=MulticlassClassificationEvaluator(labelCol='affairs',metricName='weightedPrecision').evaluate(rf_predictions)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"787d3954-927b-463b-9096-6fc3ab098e32"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["print('The precision rate on test data is {0:.0%}'.format(rf_precision))"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"f1183c4c-5774-44ec-97d3-b38ed9e9f4df"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">The precision rate on test data is 70%\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">The precision rate on test data is 70%\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["rf_precision"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"44504508-95fb-4236-8b9a-325a8e05a565"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">Out[39]: 0.6985239337191747</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">Out[39]: 0.6985239337191747</div>"]}}],"execution_count":0},{"cell_type":"code","source":["rf_auc=BinaryClassificationEvaluator(labelCol='affairs').evaluate(rf_predictions)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"fe247930-ece9-47b3-b5b7-0250c90ea2e1"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["print(rf_auc)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"118c5818-f0a8-4d79-a502-4d8d5800a3c3"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">0.7308733165961541\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">0.7308733165961541\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["# Feature importance\nrf_classifier.featureImportances"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"3379a754-8faf-4cca-97d1-986dd6f57a73"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">Out[42]: SparseVector(5, {0: 0.6602, 1: 0.0296, 2: 0.2068, 3: 0.049, 4: 0.0543})</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">Out[42]: SparseVector(5, {0: 0.6602, 1: 0.0296, 2: 0.2068, 3: 0.049, 4: 0.0543})</div>"]}}],"execution_count":0},{"cell_type":"code","source":["df.schema[\"features\"].metadata[\"ml_attr\"][\"attrs\"]"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"73a326c3-c135-481d-92b8-9652d4fdc711"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">Out[43]: {&#39;numeric&#39;: [{&#39;idx&#39;: 0, &#39;name&#39;: &#39;rate_marriage&#39;},\n  {&#39;idx&#39;: 1, &#39;name&#39;: &#39;age&#39;},\n  {&#39;idx&#39;: 2, &#39;name&#39;: &#39;yrs_married&#39;},\n  {&#39;idx&#39;: 3, &#39;name&#39;: &#39;children&#39;},\n  {&#39;idx&#39;: 4, &#39;name&#39;: &#39;religious&#39;}]}</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">Out[43]: {&#39;numeric&#39;: [{&#39;idx&#39;: 0, &#39;name&#39;: &#39;rate_marriage&#39;},\n  {&#39;idx&#39;: 1, &#39;name&#39;: &#39;age&#39;},\n  {&#39;idx&#39;: 2, &#39;name&#39;: &#39;yrs_married&#39;},\n  {&#39;idx&#39;: 3, &#39;name&#39;: &#39;children&#39;},\n  {&#39;idx&#39;: 4, &#39;name&#39;: &#39;religious&#39;}]}</div>"]}}],"execution_count":0},{"cell_type":"code","source":["rf_classifier.save(\"/FileStore/tables/RF_model\")\n"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"7e872477-b8e1-4fe0-a84f-37d3392721b5"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["rf=RandomForestClassificationModel.load(\"/FileStore/tables/RF_model\")\n"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"6c34c42f-8629-4832-9806-c879f997e5bd"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["model_preditions=rf.transform(test_df)\n"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"dee25fd5-0c21-4292-adf1-802b61dc96af"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[{"name":"model_preditions","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"rate_marriage"},{"idx":1,"name":"age"},{"idx":2,"name":"yrs_married"},{"idx":3,"name":"children"},{"idx":4,"name":"religious"}]},"num_attrs":5}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"affairs","nullable":true,"type":"integer"},{"metadata":{"ml_attr":{"num_attrs":2}},"name":"rawPrediction","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"num_attrs":2}},"name":"probability","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"num_vals":2,"type":"nominal"}},"name":"prediction","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["model_preditions.show()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"b04a58b0-6979-45b0-bf61-80f68c2c7989"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+--------------------+-------+--------------------+--------------------+----------+\n|            features|affairs|       rawPrediction|         probability|prediction|\n+--------------------+-------+--------------------+--------------------+----------+\n|[1.0,22.0,2.5,1.0...|      1|[23.3304714045879...|[0.46660942809175...|       1.0|\n|[1.0,27.0,6.0,2.0...|      1|[17.3656314035188...|[0.34731262807037...|       1.0|\n|[1.0,32.0,13.0,0....|      1|[19.2965151098106...|[0.38593030219621...|       1.0|\n|[1.0,32.0,13.0,2....|      1|[13.9565904646282...|[0.27913180929256...|       1.0|\n|[1.0,32.0,13.0,3....|      1|[15.1280118483692...|[0.30256023696738...|       1.0|\n|[1.0,32.0,16.5,2....|      1|[13.5768861176392...|[0.27153772235278...|       1.0|\n|[1.0,37.0,13.0,1....|      1|[25.7548637082375...|[0.51509727416475...|       0.0|\n|[1.0,37.0,13.0,3....|      0|[24.7979891745189...|[0.49595978349037...|       1.0|\n|[1.0,37.0,13.0,5....|      0|[18.5267269022879...|[0.37053453804575...|       1.0|\n|[1.0,37.0,16.5,2....|      1|[14.8851242739678...|[0.29770248547935...|       1.0|\n|[1.0,37.0,23.0,4....|      1|[14.6921036075894...|[0.29384207215178...|       1.0|\n|[1.0,37.0,23.0,5....|      1|[21.6793235424978...|[0.43358647084995...|       1.0|\n|[1.0,42.0,16.5,1....|      1|[14.2458117327880...|[0.28491623465576...|       1.0|\n|[1.0,42.0,16.5,5....|      1|[16.0294405788916...|[0.32058881157783...|       1.0|\n|[1.0,42.0,23.0,2....|      1|[20.0689589408374...|[0.40137917881674...|       1.0|\n|[1.0,42.0,23.0,4....|      1|[16.2511514866173...|[0.32502302973234...|       1.0|\n|[2.0,17.5,0.5,0.0...|      0|[39.1916246301276...|[0.78383249260255...|       0.0|\n|[2.0,17.5,2.5,1.0...|      0|[26.4839188504118...|[0.52967837700823...|       0.0|\n|[2.0,22.0,2.5,0.0...|      1|[22.9915029565344...|[0.45983005913068...|       1.0|\n|[2.0,22.0,2.5,0.0...|      1|[22.9915029565344...|[0.45983005913068...|       1.0|\n+--------------------+-------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\n</div>","removedWidgets":[],"addedWidgets":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+--------------------+-------+--------------------+--------------------+----------+\n            features|affairs|       rawPrediction|         probability|prediction|\n+--------------------+-------+--------------------+--------------------+----------+\n[1.0,22.0,2.5,1.0...|      1|[23.3304714045879...|[0.46660942809175...|       1.0|\n[1.0,27.0,6.0,2.0...|      1|[17.3656314035188...|[0.34731262807037...|       1.0|\n[1.0,32.0,13.0,0....|      1|[19.2965151098106...|[0.38593030219621...|       1.0|\n[1.0,32.0,13.0,2....|      1|[13.9565904646282...|[0.27913180929256...|       1.0|\n[1.0,32.0,13.0,3....|      1|[15.1280118483692...|[0.30256023696738...|       1.0|\n[1.0,32.0,16.5,2....|      1|[13.5768861176392...|[0.27153772235278...|       1.0|\n[1.0,37.0,13.0,1....|      1|[25.7548637082375...|[0.51509727416475...|       0.0|\n[1.0,37.0,13.0,3....|      0|[24.7979891745189...|[0.49595978349037...|       1.0|\n[1.0,37.0,13.0,5....|      0|[18.5267269022879...|[0.37053453804575...|       1.0|\n[1.0,37.0,16.5,2....|      1|[14.8851242739678...|[0.29770248547935...|       1.0|\n[1.0,37.0,23.0,4....|      1|[14.6921036075894...|[0.29384207215178...|       1.0|\n[1.0,37.0,23.0,5....|      1|[21.6793235424978...|[0.43358647084995...|       1.0|\n[1.0,42.0,16.5,1....|      1|[14.2458117327880...|[0.28491623465576...|       1.0|\n[1.0,42.0,16.5,5....|      1|[16.0294405788916...|[0.32058881157783...|       1.0|\n[1.0,42.0,23.0,2....|      1|[20.0689589408374...|[0.40137917881674...|       1.0|\n[1.0,42.0,23.0,4....|      1|[16.2511514866173...|[0.32502302973234...|       1.0|\n[2.0,17.5,0.5,0.0...|      0|[39.1916246301276...|[0.78383249260255...|       0.0|\n[2.0,17.5,2.5,1.0...|      0|[26.4839188504118...|[0.52967837700823...|       0.0|\n[2.0,22.0,2.5,0.0...|      1|[22.9915029565344...|[0.45983005913068...|       1.0|\n[2.0,22.0,2.5,0.0...|      1|[22.9915029565344...|[0.45983005913068...|       1.0|\n+--------------------+-------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":[""],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"9b56effc-5f85-478f-9c9f-70ef88dd8218"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"type":"ipynbError","data":"","errorSummary":"","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>"]}}],"execution_count":0}],"metadata":{"application/vnd.databricks.v1+notebook":{"notebookName":"RandomForest","dashboards":[],"language":"python","widgets":{},"notebookOrigID":1759005612513663}},"nbformat":4,"nbformat_minor":0}
